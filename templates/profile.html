<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your Profile</title>
</head>
<body>
    <h2>Welcome, {{ current_user.username }}</h2>

    <!-- Display Profile Picture -->
    {% if current_user.profile_pic %}
        <img src="{{ url_for('static', filename='profile_pics/' + current_user.profile_pic.split('/')[-1]) }}" alt="Profile Picture">
    {% else %}
        <p>No profile picture uploaded</p>
    {% endif %}

    <h3>Uploaded Images</h3>
    <ul>
        {% for image in images %}
            <li>
                <img src="{{ url_for('static', filename='uploads/' + image['filename']) }}" alt="Image">
                <p>Uploaded by: <a href="{{ url_for('view_profile', user_id=image['user_id']) }}">{{ image['user_id'] }}</a></p>
                <form method="POST" action="{{ url_for('comment_on_image', image_id=image['_id']) }}">
                    <input type="text" name="comment" placeholder="Add a comment" required>
                    <button type="submit">Comment</button>
                </form>
                <form method="POST" action="{{ url_for('delete_image', image_id=image['_id']) }}">
                    <button type="submit">Delete</button>
                </form>
                <ul>
                    {% for comment in image.comments %}
                        <li>{{ comment['comment'] }} - <strong>{{ comment['user_id'] }}</strong></li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>

    <h3>Upload New Image</h3>
    <form method="POST" action="{{ url_for('upload_image') }}" enctype="multipart/form-data">
        <input type="file" name="file" accept="image/*" required>
        <button type="submit">Upload</button>
    </form>

    <h3>Other Users</h3>
    <ul>
        {% for user in users %}
            {% if user['_id'] != current_user.id %}
                <li><a href="{{ url_for('view_profile', user_id=user['_id']) }}">{{ user['username'] }}</a></li>
            {% endif %}
        {% endfor %}
    </ul>

    <a href="{{ url_for('logout') }}">Logout</a>
</body>
</html>
